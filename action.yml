name: 'AI Workflow Runner'
description: 'Run AI workflows with Node.js, Python, and Java runtime support'
author: 'TanNT'

inputs:
  workflow_path:
    description: 'Path to the workflow.md file (relative to workspace root)'
    required: true
  prompt:
    description: 'Input prompt to pass to the workflow (max 100KB)'
    required: false
    default: ''
  env_vars:
    description: 'JSON object of environment variables (max 64KB, 100 entries)'
    required: false
    default: '{}'
  timeout_minutes:
    description: 'Maximum execution time in minutes (default: 30)'
    required: false
    default: '30'
  validation_script:
    description: 'Optional validation script (file path like check.py or inline with prefix like python:print("ok")). Receives AI_LAST_MESSAGE env. Return empty/true for success, other string to continue workflow.'
    required: false
    default: ''
  validation_script_type:
    description: 'Script type for inline scripts: python or javascript. Auto-detected for file paths by extension (.py or .js). Only required when validation_script is set and type cannot be auto-detected.'
    required: false
    default: ''
  validation_max_retry:
    description: 'Maximum validation retry attempts when script returns non-empty/non-true (default: 5, max: 20)'
    required: false
    default: '5'
  opencode_config:
    description: 'Path to OpenCode config.json file (relative to workspace). Contains provider and model settings.'
    required: false
    default: ''
  auth_config:
    description: 'Path to OpenCode auth.json file (relative to workspace). Contains API keys and authentication. Store in GitHub Secrets, not Variables.'
    required: false
    default: ''
  model:
    description: 'Model to use for AI execution (e.g., "anthropic/claude-3-opus"). Overrides config file default.'
    required: false
    default: ''
  list_models:
    description: 'If "true", print available models and exit without running workflow'
    required: false
    default: 'false'

outputs:
  status:
    description: 'Execution status: success, failure, cancelled, or timeout'
  result:
    description: 'Workflow execution result as JSON string (max 900KB)'

runs:
  using: 'docker'
  image: 'Dockerfile'

branding:
  icon: 'play-circle'
  color: 'green'
