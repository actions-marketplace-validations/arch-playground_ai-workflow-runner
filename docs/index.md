# AI Workflow Runner - Documentation Index

> **Primary AI Retrieval Source** - Use this index when working with the ai-workflow-runner codebase.

## Project Overview

| Property             | Value                                       |
| -------------------- | ------------------------------------------- |
| **Type**             | Monolith - GitHub Action (Docker container) |
| **Primary Language** | TypeScript                                  |
| **Runtime**          | Node.js 20+                                 |
| **Architecture**     | Modular service-based                       |
| **License**          | MIT                                         |

## Quick Reference

| Category                 | Details                                           |
| ------------------------ | ------------------------------------------------- |
| **Tech Stack**           | TypeScript 5.3, Node.js 20, esbuild, Jest, Docker |
| **Entry Point**          | `src/index.ts` â†’ `dist/index.js`                  |
| **Architecture Pattern** | Modular services with clean separation            |
| **Key Dependencies**     | @actions/core, @opencode-ai/sdk                   |

## Generated Documentation

| Document                                          | Description                             |
| ------------------------------------------------- | --------------------------------------- |
| [Project Overview](./project-overview.md)         | Executive summary, features, tech stack |
| [Architecture](./architecture.md)                 | System design, modules, data flow       |
| [Source Tree Analysis](./source-tree-analysis.md) | Directory structure, file purposes      |
| [Development Guide](./development-guide.md)       | Setup, workflows, debugging             |
| [API Contracts](./api-contracts.md)               | Inputs, outputs, validation rules       |

## Existing Documentation

| Document                  | Description                               |
| ------------------------- | ----------------------------------------- |
| [README.md](../README.md) | User-facing documentation, usage examples |
| [AGENTS.md](../AGENTS.md) | AI agent guidelines and standards         |
| [LICENSE](../LICENSE)     | MIT license                               |

## Source Code Reference

### Core Modules

| Module      | File                | Purpose                    |
| ----------- | ------------------- | -------------------------- |
| Entry Point | `src/index.ts`      | Bootstrap, signal handling |
| Runner      | `src/runner.ts`     | Workflow execution         |
| Config      | `src/config.ts`     | Input parsing              |
| Security    | `src/security.ts`   | Path validation            |
| OpenCode    | `src/opencode.ts`   | SDK integration            |
| Validation  | `src/validation.ts` | Script execution           |
| Types       | `src/types.ts`      | Type definitions           |

### Test Files

| Test Type   | Location            |
| ----------- | ------------------- |
| Unit Tests  | `src/*.spec.ts`     |
| Integration | `test/integration/` |
| E2E Tests   | `test/e2e/`         |

### Configuration

| File             | Purpose                  |
| ---------------- | ------------------------ |
| `action.yml`     | GitHub Action definition |
| `Dockerfile`     | Multi-runtime container  |
| `package.json`   | Dependencies and scripts |
| `tsconfig.json`  | TypeScript config        |
| `jest.config.js` | Test configuration       |

## Getting Started

```bash
# Install dependencies
npm install

# Run quality checks
npm run lint && npm run typecheck

# Run tests
npm run test:unit

# Build
npm run bundle

# Build Docker
docker build -t ai-workflow-runner:local .
```

## Key Concepts

### Workflow Execution Flow

1. Parse and validate inputs
2. Read and validate workflow file
3. Initialize OpenCode SDK
4. Execute workflow via SDK
5. (Optional) Run validation script
6. Return result

### Security Model

- Path traversal prevention
- Symlink escape detection
- Reserved env var blocking
- Secret masking
- Input size limits

### Validation Scripts

- Supports Python and JavaScript
- File-based or inline
- Receives `AI_LAST_MESSAGE` env var
- Returns empty/"true" for success
- Other output triggers retry

---

_Generated by BMAD Document Project Workflow v1.2.0_
_Scan Level: Exhaustive_
_Generated: 2026-02-04_
